<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--<meta charset="UTF-8" />-->
<!--<title>SentinelAI Threat Dashboard v6 Hyper Vision</title>-->

<!--<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">-->
<!--<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">-->

<!--<style>-->
<!--    body {-->
<!--        background: linear-gradient(160deg, #020617 0%, #000000 60%);-->
<!--        color: #cfe3ff;-->
<!--        padding: 30px;-->
<!--        font-family: "Inter", sans-serif;-->
<!--    }-->

<!--    /* HEADLINE */-->
<!--    .cyber-h1 {-->
<!--        font-size: 2.7rem;-->
<!--        font-weight: 800;-->
<!--        background: linear-gradient(90deg, #00eaff, #00c3ff, #8af6ff);-->
<!--        -webkit-background-clip: text;-->
<!--        color: transparent;-->
<!--        animation: glow 3s infinite alternate;-->
<!--    }-->

<!--    @keyframes glow {-->
<!--        from { text-shadow: 0 0 15px #00caff; }-->
<!--        to   { text-shadow: 0 0 35px #00faff; }-->
<!--    }-->

<!--    /* PANEL STYLE */-->
<!--    .glass-card {-->
<!--        background: rgba(255,255,255,0.04);-->
<!--        border: 1px solid rgba(0,200,255,0.15);-->
<!--        border-radius: 18px;-->
<!--        padding: 24px;-->
<!--        backdrop-filter: blur(12px);-->
<!--        box-shadow: 0 0 35px rgba(0,180,255,0.12);-->
<!--        transition: 0.25s;-->
<!--    }-->

<!--    .glass-card:hover {-->
<!--        box-shadow: 0 0 55px rgba(0,220,255,0.28);-->
<!--        border: 1px solid rgba(0,255,255,0.35);-->
<!--    }-->

<!--    /* BUTTON */-->
<!--    .btn-analyze {-->
<!--        background: linear-gradient(90deg, #00ffa6, #00c8ff);-->
<!--        border: none;-->
<!--        padding: 10px 25px;-->
<!--        border-radius: 12px;-->
<!--        color: #000;-->
<!--        font-weight: 600;-->
<!--    }-->

<!--    .btn-analyze:hover {-->
<!--        transform: scale(1.05);-->
<!--    }-->

<!--    .btn-download {-->
<!--        background: rgba(0, 150, 255, 0.2);-->
<!--        border: 1px solid #00c8ff;-->
<!--        padding: 8px 18px;-->
<!--        border-radius: 12px;-->
<!--        color: #00d8ff;-->
<!--        font-weight: 500;-->
<!--    }-->

<!--    textarea {-->
<!--        background: rgba(0,0,0,0.55) !important;-->
<!--        border: 1px solid rgba(0,255,255,0.25) !important;-->
<!--        color: #cfe3ff !important;-->
<!--    }-->

<!--    textarea::placeholder {-->
<!--        color: #bfc7d9 !important;-->
<!--        opacity: 0.6 !important;-->
<!--    }-->

<!--    /* LOADING OVERLAY */-->
<!--    #spinnerOverlay {-->
<!--        display: none;-->
<!--        position: fixed;-->
<!--        inset: 0;-->
<!--        background: rgba(0,0,0,0.7);-->
<!--        z-index: 9999;-->
<!--        justify-content: center;-->
<!--        align-items: center;-->
<!--        flex-direction: column;-->
<!--    }-->

<!--    .ioc-pill {-->
<!--        background: rgba(0, 150, 255, 0.15);-->
<!--        border: 1px solid #00bfff;-->
<!--        padding: 6px 12px;-->
<!--        border-radius: 12px;-->
<!--        margin: 4px;-->
<!--        display: inline-flex;-->
<!--        gap: 6px;-->
<!--        align-items: center;-->
<!--    }-->

<!--    .summary-box {-->
<!--        border-left: 4px solid #00eaff;-->
<!--        padding-left: 12px;-->
<!--        margin-top: 10px;-->
<!--    }-->

<!--    .timeline-item {-->
<!--        display: flex;-->
<!--        align-items: center;-->
<!--        gap: 10px;-->
<!--        margin: 6px 0;-->
<!--    }-->

<!--    .timeline-dot {-->
<!--        width: 12px;-->
<!--        height: 12px;-->
<!--        background: #00d4ff;-->
<!--        border-radius: 50%;-->
<!--        box-shadow: 0 0 10px #00eaff;-->
<!--    }-->

<!--    .severity-badge {-->
<!--        padding: 6px 14px;-->
<!--        border-radius: 12px;-->
<!--        margin-top: 8px;-->
<!--        font-weight: 700;-->
<!--        display: inline-block;-->
<!--    }-->

<!--    .sev-low { background: #00ff99; color: #003300; }-->
<!--    .sev-med { background: #ffe066; color: #5c4300; }-->
<!--    .sev-high { background: #ff7b00; color: #331a00; }-->
<!--    .sev-critical { background: #ff003c; color: #330008; }-->

<!--    .logout-btn {-->
<!--        position: absolute;-->
<!--        top: 22px;-->
<!--        right: 32px;-->
<!--    }-->
<!--</style>-->
<!--</head>-->

<!--<body>-->

<!--&lt;!&ndash; LOGOUT BUTTON (correct position) &ndash;&gt;-->
<!--<a href="/analytics" class="btn btn-warning">ðŸ“Š Analytics</a>-->
<!--<a href="/logout" class="btn btn-danger logout-btn">Logout</a>-->


<!--&lt;!&ndash; LOADING OVERLAY &ndash;&gt;-->
<!--<div id="spinnerOverlay">-->
<!--    <div class="spinner-border text-info" style="width: 70px; height: 70px;"></div>-->
<!--    <p class="mt-3 text-white">Analyzing logs...</p>-->
<!--</div>-->

<!--<div class="container">-->

<!--    <h1 class="cyber-h1 text-center mb-4">ðŸ›¡ SentinelAI Threat</h1>-->

<!--    &lt;!&ndash; INPUT PANEL &ndash;&gt;-->
<!--    <div class="glass-card mb-4">-->
<!--        <h4>Enter Logs</h4>-->
<!--        <textarea id="logInput" class="form-control mb-3" rows="6" placeholder="Paste logs here..."></textarea>-->

<!--        <button class="btn-analyze" onclick="analyzeLog()">Analyze</button>-->
<!--        <button class="btn-download ms-2" onclick="downloadReport()">â¬‡ Download PDF</button>-->
<!--    </div>-->

<!--    &lt;!&ndash; OUTPUT PANEL &ndash;&gt;-->
<!--    <div class="glass-card">-->
<!--        <h4>Output</h4>-->
<!--        <div id="output" class="mt-3">Awaiting input...</div>-->
<!--    </div>-->

<!--</div>-->

<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>-->

<!--<script>-->
<!--async function analyzeLog() {-->
<!--    const text = document.getElementById("logInput").value;-->
<!--    const spinner = document.getElementById("spinnerOverlay");-->
<!--    const output = document.getElementById("output");-->

<!--    if (!text.trim()) {-->
<!--        output.innerHTML = "<p class='text-danger'>Please enter logs.</p>";-->
<!--        return;-->
<!--    }-->

<!--    spinner.style.display = "flex";-->

<!--    try {-->
<!--        let res = await fetch("/fusion", {-->
<!--            method: "POST",-->
<!--            headers: { "Content-Type": "application/json" },-->
<!--            body: JSON.stringify({ text })-->
<!--        });-->

<!--        const data = await res.json();-->
<!--        spinner.style.display = "none";-->

<!--        if (!res.ok) {-->
<!--            output.innerHTML = `<p class='text-danger'>Error: ${data.detail}</p>`;-->
<!--            return;-->
<!--        }-->

<!--        let sev = ["sev-low", "sev-med", "sev-high", "sev-critical"][Math.min(data.threat_type, 3)];-->
<!--        let sevText = ["Low", "Medium", "High", "Critical"][Math.min(data.threat_type, 3)];-->

<!--        output.innerHTML = `-->
<!--            <h5>Threat Classification:</h5>-->
<!--            <span class="severity-badge ${sev}">${sevText} (Level ${data.threat_type})</span>-->

<!--            <h5 class="mt-4">IOC Extraction:</h5>-->
<!--            <div>-->
<!--                ${Object.entries(data.iocs).map(([type, arr]) =>-->
<!--                    arr.map(val => `-->
<!--                        <span class="ioc-pill">-->
<!--                            ${icon(type)} ${val}-->
<!--                        </span>`).join("")-->
<!--                ).join("")}-->
<!--            </div>-->

<!--            <h5 class="mt-4">Summary:</h5>-->
<!--            <div class="summary-box">${data.summary}</div>-->

<!--            <h5 class="mt-4">Event Timeline:</h5>-->
<!--            <div>-->
<!--                ${data.summary.split(". ").map(s =>-->
<!--                    s.trim() ? `-->
<!--                        <div class="timeline-item">-->
<!--                            <div class="timeline-dot"></div>-->
<!--                            <span>${s}</span>-->
<!--                        </div>` : ""-->
<!--                ).join("")}-->
<!--            </div>-->

<!--            <h5 class="mt-4">Anomaly Score:</h5>-->
<!--            <p style="font-size:1.5rem; font-weight:bold;">${data.anomaly_score}</p>-->
<!--        `;-->
<!--    }-->
<!--    catch (e) {-->
<!--        spinner.style.display = "none";-->
<!--        output.innerHTML = "<p class='text-danger'>Error: Could not analyze logs.</p>";-->
<!--    }-->
<!--}-->

<!--function icon(type) {-->
<!--    return {-->
<!--        ips: "ðŸŒ",-->
<!--        urls: "ðŸ”—",-->
<!--        domains: "ðŸŒ",-->
<!--        hashes: "ðŸ”’",-->
<!--        cves: "âš ï¸",-->
<!--        emails: "ðŸ“§"-->
<!--    }[type] || "â€¢";-->
<!--}-->

<!--function downloadReport() {-->
<!--    const element = document.querySelector(".glass-card:last-of-type");-->
<!--    html2canvas(element).then(canvas => {-->
<!--        const link = document.createElement("a");-->
<!--        link.download = "SentinelAI_Report.png";-->
<!--        link.href = canvas.toDataURL("image/png");-->
<!--        link.click();-->
<!--    });-->
<!--}-->
<!--</script>-->

<!--</body>-->
<!--</html>-->



<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>SentinelAI Threat Dashboard v6 Hyper Vision</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

<style>
    body {
        background: linear-gradient(160deg, #020617 0%, #000000 60%);
        color: #cfe3ff;
        padding: 30px;
        font-family: "Inter", sans-serif;
    }

    /* HEADLINE */
    .cyber-h1 {
        font-size: 2.7rem;
        font-weight: 800;
        background: linear-gradient(90deg, #00eaff, #00c3ff, #8af6ff);
        -webkit-background-clip: text;
        color: transparent;
        animation: glow 3s infinite alternate;
    }

    @keyframes glow {
        from { text-shadow: 0 0 15px #00caff; }
        to   { text-shadow: 0 0 35px #00faff; }
    }

    /* PANEL STYLE */
    .glass-card {
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(0,200,255,0.15);
        border-radius: 18px;
        padding: 24px;
        backdrop-filter: blur(12px);
        box-shadow: 0 0 35px rgba(0,180,255,0.12);
        transition: 0.25s;
    }

    .glass-card:hover {
        box-shadow: 0 0 55px rgba(0,220,255,0.28);
        border: 1px solid rgba(0,255,255,0.35);
    }

    /* BUTTON */
    .btn-analyze {
        background: linear-gradient(90deg, #00ffa6, #00c8ff);
        border: none;
        padding: 10px 25px;
        border-radius: 12px;
        color: #000;
        font-weight: 600;
    }

    .btn-analyze:hover {
        transform: scale(1.05);
    }

    .btn-download {
        background: rgba(0, 150, 255, 0.2);
        border: 1px solid #00c8ff;
        padding: 8px 18px;
        border-radius: 12px;
        color: #00d8ff;
        font-weight: 500;
    }

    textarea {
        background: rgba(0,0,0,0.55) !important;
        border: 1px solid rgba(0,255,255,0.25) !important;
        color: #cfe3ff !important;
    }

    textarea::placeholder {
        color: #bfc7d9 !important;
        opacity: 0.6 !important;
    }

    /* LOADING OVERLAY */
    #spinnerOverlay {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.7);
        z-index: 9999;
        justify-content: center;
        align-items: center;
        flex-direction: column;
    }

    .ioc-pill {
        background: rgba(0, 150, 255, 0.15);
        border: 1px solid #00bfff;
        padding: 6px 12px;
        border-radius: 12px;
        margin: 4px;
        display: inline-flex;
        gap: 6px;
        align-items: center;
    }

    .summary-box {
        border-left: 4px solid #00eaff;
        padding-left: 12px;
        margin-top: 10px;
    }

    .timeline-item {
        display: flex;
        align-items: center;
        gap: 10px;
        margin: 6px 0;
    }

    .timeline-dot {
        width: 12px;
        height: 12px;
        background: #00d4ff;
        border-radius: 50%;
        box-shadow: 0 0 10px #00eaff;
    }

    .severity-badge {
        padding: 6px 14px;
        border-radius: 12px;
        margin-top: 8px;
        font-weight: 700;
        display: inline-block;
    }

    .sev-low { background: #00ff99; color: #003300; }
    .sev-med { background: #ffe066; color: #5c4300; }
    .sev-high { background: #ff7b00; color: #331a00; }
    .sev-critical { background: #ff003c; color: #330008; }

    .logout-btn {
        position: absolute;
        top: 22px;
        right: 32px;
    }
</style>
</head>

<body>

<!-- LOGOUT BUTTON (correct position) -->
<a href="/analytics" class="btn btn-warning">ðŸ“Š Analytics</a>
<a href="/logout" class="btn btn-danger logout-btn">Logout</a>


<!-- LOADING OVERLAY -->
<div id="spinnerOverlay">
    <div class="spinner-border text-info" style="width: 70px; height: 70px;"></div>
    <p class="mt-3 text-white">Analyzing logs...</p>
</div>

<div class="container">

    <h1 class="cyber-h1 text-center mb-4">ðŸ›¡ SentinelAI Threat</h1>

    <!-- INPUT PANEL -->
    <div class="glass-card mb-4">
        <h4>Enter Logs</h4>
        <textarea id="logInput" class="form-control mb-3" rows="6" placeholder="Paste logs here..."></textarea>

        <button class="btn-analyze" onclick="analyzeLog()">Analyze</button>
        <button class="btn-download ms-2" onclick="downloadReport()">â¬‡ Download PDF</button>
    </div>

    <!-- OUTPUT PANEL -->
    <div class="glass-card">
        <h4>Output</h4>
        <div id="output" class="mt-3">Awaiting input...</div>
    </div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
async function analyzeLog() {
    const text = document.getElementById("logInput").value;
    const spinner = document.getElementById("spinnerOverlay");
    const output = document.getElementById("output");

    if (!text.trim()) {
        output.innerHTML = "<p class='text-danger'>Please enter logs.</p>";
        return;
    }

    spinner.style.display = "flex";

    try {
        let res = await fetch("/fusion", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ text })
        });

        const data = await res.json();
        spinner.style.display = "none";

        if (!res.ok) {
            output.innerHTML = `<p class='text-danger'>Error: ${data.detail}</p>`;
            return;
        }

        let sevClass = ["sev-low", "sev-med", "sev-high", "sev-critical"][Math.min(data.threat_type, 3)];
        let sevText = ["Low", "Medium", "High", "Critical"][Math.min(data.threat_type, 3)];

        // Build timeline from the original log lines (not the summary)
        const rawLines = text.split("\n")
            .map(l => l.trim())
            .filter(l => l.length > 0);

        const timelineHtml = rawLines.map(line => `
            <div class="timeline-item">
                <div class="timeline-dot"></div>
                <span>${line}</span>
            </div>
        `).join("");

        output.innerHTML = `
            <h5>Threat Classification:</h5>
            <span class="severity-badge ${sevClass}">${sevText} (Level ${data.threat_type})</span>

            <h5 class="mt-4">IOC Extraction:</h5>
            <div>
                ${Object.entries(data.iocs).map(([type, arr]) =>
                    arr.map(val => `
                        <span class="ioc-pill">
                            ${icon(type)} ${val}
                        </span>`).join("")
                ).join("")}
            </div>

            <h5 class="mt-4">Summary:</h5>
            <div class="summary-box">${data.summary}</div>

            <h5 class="mt-4">Event Timeline:</h5>
            <div>
                ${timelineHtml}
            </div>

            <h5 class="mt-4">Anomaly Score:</h5>
            <p style="font-size:1.5rem; font-weight:bold;">${data.anomaly_score}</p>
        `;
    }
    catch (e) {
        spinner.style.display = "none";
        output.innerHTML = "<p class='text-danger'>Error: Could not analyze logs.</p>";
    }
}

function icon(type) {
    return {
        ips: "ðŸŒ",
        urls: "ðŸ”—",
        domains: "ðŸŒ",
        hashes: "ðŸ”’",
        cves: "âš ï¸",
        emails: "ðŸ“§"
    }[type] || "â€¢";
}

function downloadReport() {
    const element = document.querySelector(".glass-card:last-of-type");
    html2canvas(element).then(canvas => {
        const link = document.createElement("a");
        link.download = "SentinelAI_Report.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
    });
}
</script>

</body>
</html>
